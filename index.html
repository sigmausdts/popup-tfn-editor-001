<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Edit JSON Data</title>
</head>
<body>
  <h2>Edit TFN in data.json</h2>
  <input type="text" id="nameInput" placeholder="Enter new TFN" />
  <button onclick="updateData()">Save</button>
  <p id="status"></p>

  <script>
    async function updateData() {
      const newValue = document.getElementById("nameInput").value;
      if (!newValue) {
        document.getElementById("status").innerText = "⚠ Please enter a value.";
        return;
      }

      const workflowUrl = "https://api.github.com/repos/sigmausdts/popup-tfn-editor-001/actions/workflows/send-dispatch.yml/dispatches";

      const token = ""; //  No token in browser — uses GitHub Actions only

      const body = {
        ref: "main", // branch in Repo A
        inputs: {
          newData: JSON.stringify({ tfn: newValue })
        }
      };

      const res = await fetch(workflowUrl, {
        method: "POST",
        headers: {
          "Accept": "application/vnd.github+json",
          "Authorization": "token " + token //  no token here
        },
        body: JSON.stringify(body)
      });

      if (res.ok) {
        document.getElementById("status").innerText = " Update triggered!";
      } else {
        document.getElementById("status").innerText = " Error: " + res.status;
      }
    }
  </script>
</body>
</html>
